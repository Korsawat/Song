(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,a){},13:function(e,t,a){},14:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(2),o=a.n(r);a(12);const s=e=>{localStorage.setItem("spotify_access_token",e)},l=()=>{localStorage.removeItem("spotify_access_token")},i="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("e09c3389cd8f4a0c92f03e1bc5b423c2","&redirect_uri=").concat("https://korsawat.github.io/Song/","&scope=").concat(["user-library-read"].join("%20"),"&response_type=token&show_dialog=true");a(13);var m=()=>{const[e,t]=Object(n.useState)(""),[a,r]=Object(n.useState)([]),[o,m]=Object(n.useState)([]),[u,d]=Object(n.useState)([null,null]),[g,k]=Object(n.useState)(0),[E,h]=Object(n.useState)(!1);Object(n.useEffect)(()=>{const e=localStorage.getItem("spotify_access_token");e?(t(e),w(e)):p()},[]);const p=()=>{const e=(()=>{const e=window.location.hash.substring(1),t=new URLSearchParams(e).get("access_token");return t&&s(t),{access_token:t}})();window.location.hash="";const a=e.access_token;a&&(t(a),s(a),w(a))},w=async e=>{try{const a=await(async e=>{let t,a=0,n=[];try{do{const c="https://api.spotify.com/v1/me/tracks?limit=50&offset="+a,r={Authorization:"Bearer "+e},o=await fetch(c,{headers:r});if(!o.ok){const e=await o.text();throw console.error("Response Status:",o.status),console.error("Response Text:",e),403===o.status?new Error("Access forbidden. Check Spotify API permissions."):new Error("HTTP error! Status: ".concat(o.status))}t=await o.json(),n=n.concat(t.items),a+=50}while(a<t.total)}catch(c){throw console.error("Error fetching songs:",c.message),c}return n.map(e=>({track:e.track,compared:!1,wins:0}))})(e);r(a.map(e=>({...e,compared:!1}))),k(0);const n=f(a);m(n),b(n)}catch(t){console.error("Error fetching songs:",t.message),l()}},f=e=>{const t=[];for(let a=0;a<e.length-1;a++)for(let n=a+1;n<e.length;n++)t.push([e[a],e[n]]);return t},b=e=>{const t=e.filter(e=>!e[0].compared||!e[1].compared);if(0===t.length)return void h(!0);const a=Math.floor(Math.random()*t.length);d(t[a]),m(e.filter(e=>e!==t[a]))},S=(e,t)=>{const n=a.map(t=>t.track.id===e.track.id?{...t,compared:!0,wins:(t.wins||0)+1}:t);r(n),b(o)},v=()=>{l(),t(""),r([]),m([]),d([null,null]),k(0),h(!1)};return c.a.createElement("div",{className:"App"},c.a.createElement("div",{className:"header"},"Song Comparison"),e?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"total-liked-songs"},"Total Liked Songs: ",a.length),E?c.a.createElement("div",{className:"ranked-songs"},c.a.createElement("h2",null,"Ranked Songs"),c.a.createElement("table",null,c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Rank"),c.a.createElement("th",null,"Song Name"))),c.a.createElement("tbody",null,(()=>{const e=a.sort((e,t)=>(t.wins||0)-(e.wins||0));let t=1;return e.forEach((a,n)=>{n>0&&(a.wins||0)!==(e[n-1].wins||0)&&(t=n+1),a.rank=t}),e})().map(e=>c.a.createElement("tr",{key:e.track.id},c.a.createElement("td",null,e.rank),c.a.createElement("td",null,e.track.name))))),c.a.createElement("button",{onClick:v},"Logout")):c.a.createElement(c.a.Fragment,null,u[0]&&u[1]?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"song-container"},c.a.createElement("div",{className:"song",onClick:()=>S(u[0],u[1])},c.a.createElement("img",{src:u[0].track.album.images[0].url,alt:u[0].track.name}),c.a.createElement("div",null,u[0].track.name)),c.a.createElement("div",{className:"song",onClick:()=>S(u[1],u[0])},c.a.createElement("img",{src:u[1].track.album.images[0].url,alt:u[1].track.name}),c.a.createElement("div",null,u[1].track.name))),c.a.createElement("div",{className:"progress-container"},c.a.createElement("div",{className:"progress-bar"},c.a.createElement("div",{className:"progress",style:{width:"".concat(g,"%")}},Math.round(g),"%"))),c.a.createElement("div",{className:"buttons"},c.a.createElement("div",{className:"buttons-container"},c.a.createElement("button",{onClick:()=>{const e=a.map(e=>e.track.id===u[0].track.id||e.track.id===u[1].track.id?{...e,compared:!0,wins:(e.wins||0)+1}:e);r(e),b(o)}},"Can't Decide")),c.a.createElement("button",{onClick:()=>{h(!0)}},"Show Ranked Songs"),c.a.createElement("button",{onClick:v},"Logout"))):c.a.createElement("div",null,"Loading..."))):c.a.createElement("a",{href:i},"Login to Spotify"))};var u=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,15)).then(t=>{let{getCLS:a,getFID:n,getFCP:c,getLCP:r,getTTFB:o}=t;a(e),n(e),c(e),r(e),o(e)})};o.a.createRoot(document.getElementById("root")).render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(m,null))),u()},3:function(e,t,a){e.exports=a(14)}},[[3,1,2]]]);
//# sourceMappingURL=main.f4a3f42e.chunk.js.map